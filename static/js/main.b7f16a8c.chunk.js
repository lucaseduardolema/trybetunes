(this.webpackJsonptrybetunes=this.webpackJsonptrybetunes||[]).push([[0],{30:function(e,t,a){},41:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(22),i=a.n(s),c=(a(30),a(3)),o=a(4),u=a(6),l=a(5),d=a(8),j=a(2),b=a.n(j),h=a(7),p=a(13),O=a(15),m="user",f=function(e){return localStorage.setItem(m,JSON.stringify(e))},v=function(e){return function(t){setTimeout((function(){t(e)}),1500)}},x=function(){return new Promise((function(e){var t=JSON.parse(localStorage.getItem(m));null===t&&(t={}),v(t)(e)}))},g=function(e){return new Promise((function(t){f(Object(O.a)(Object(O.a)({},{name:"",email:"",image:"",description:""}),e)),v("OK")(t)}))},k=a(18),y=a.n(k),w=a(0),S=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).handleGetUser=function(){e.setState({isLoading:!0},Object(h.a)(b.a.mark((function t(){var a;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x();case 2:a=t.sent,e.setState({name:a.name,isLoading:!1});case 4:case"end":return t.stop()}}),t)}))))},e.state={name:"",isLoading:!1},e}return Object(o.a)(a,[{key:"componentDidMount",value:function(){this.handleGetUser()}},{key:"render",value:function(){var e=this.state,t=e.name,a=e.isLoading;return Object(w.jsxs)("header",{"data-testid":"header-component",children:[Object(w.jsx)("div",{className:"logo-header"}),Object(w.jsxs)("nav",{children:[Object(w.jsx)(p.b,{"data-testid":"link-to-search",to:"/trybetunes/search",children:"Busca"}),Object(w.jsx)(p.b,{"data-testid":"link-to-favorites",to:"/trybetunes/favorites",children:"Favoritos"}),Object(w.jsx)(p.b,{"data-testid":"link-to-profile",to:"/trybetunes/profile",children:"Perfil"})]}),Object(w.jsx)("div",{className:"user-info",children:a?Object(w.jsx)(y.a,{color:"#f72585",type:"bars",width:"40px",height:"40px"}):Object(w.jsxs)("p",{children:["Ol\xe1 ",Object(w.jsx)("span",{"data-testid":"header-user-name",children:t})]})})]})}}]),a}(r.a.Component),C=a(25),F="favorite_songs";JSON.parse(localStorage.getItem(F))||localStorage.setItem(F,JSON.stringify([]));var L=function(){return JSON.parse(localStorage.getItem(F))},I=function(e){return localStorage.setItem(F,JSON.stringify(e))},N=function(e){return function(t){setTimeout((function(){t(e)}),500)}},U=function(){return new Promise((function(e){var t=L();N(t)(e)}))},D=function(e){return new Promise((function(t){if(e){var a=L();I([].concat(Object(C.a)(a),[e]))}N("OK")(t)}))},P=function(e){return new Promise((function(t){var a=L();I(a.filter((function(t){return t.trackId!==e.trackId}))),N("OK")(t)}))},E=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){return Object(w.jsx)("p",{children:"Carregando..."})}}]),a}(r.a.Component),J=E,R=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).isFavorite=function(){var t=e.props,a=t.favorites,n=t.trackId;a.some((function(e){return e.trackId===n}))?e.setState({isFav:!0}):e.setState({isFav:!1})},e.handleFav=function(){e.setState((function(e){return{isLoading:!0,isFav:!e.isFav}}),Object(h.a)(b.a.mark((function t(){var a;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.props.objTotal,!e.state.isFav){t.next=8;break}return t.next=5,D(a);case 5:e.setState({isLoading:!1}),t.next=11;break;case 8:return t.next=10,P(a);case 10:e.setState({isLoading:!1});case 11:case"end":return t.stop()}}),t)}))))},e.state={isLoading:!1,isFav:!1},e}return Object(o.a)(a,[{key:"componentDidMount",value:function(){this.isFavorite()}},{key:"render",value:function(){var e=this.state,t=e.isLoading,a=e.isFav,n=this.props,r=n.trackName,s=n.previewUrl,i=n.trackId,c=Object(w.jsxs)("div",{children:[Object(w.jsx)("p",{children:r}),Object(w.jsxs)("audio",{"data-testid":"audio-component",src:s,controls:!0,children:[Object(w.jsx)("track",{kind:"captions"}),"O seu navegador n\xe3o suporta o elemento"," "," ",Object(w.jsx)("code",{children:"audio"}),"."]}),Object(w.jsxs)("label",{htmlFor:i,"data-testid":"checkbox-music-".concat(i),children:["Favorita",Object(w.jsx)("input",{id:i,name:"fav",type:"checkbox",value:i,checked:a,onChange:this.handleFav})]})]});return Object(w.jsx)("div",{children:t?Object(w.jsx)(J,{}):c})}}]),a}(r.a.Component),M=function(){var e=Object(h.a)(b.a.mark((function e(t){var a,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://itunes.apple.com/lookup?id=".concat(t,"&entity=song"));case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n.results);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=M,A=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).fetchAlbum=Object(h.a)(b.a.mark((function t(){var a,n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.props.match.params.id,t.next=3,T(a);case 3:n=t.sent,e.setState({info:n[0],musics:n.slice(1)});case 5:case"end":return t.stop()}}),t)}))),e.favorites=function(){e.setState({isLoading:!0},Object(h.a)(b.a.mark((function t(){var a;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,U();case 2:a=t.sent,e.setState({isLoading:!1,favorites:a});case 4:case"end":return t.stop()}}),t)}))))},e.state={isLoading:!1,info:{},musics:[],favorites:[]},e}return Object(o.a)(a,[{key:"componentDidMount",value:function(){this.fetchAlbum(),this.favorites()}},{key:"render",value:function(){var e=this.state,t=e.musics,a=e.info,n=e.isLoading,r=e.favorites,s=Object(w.jsx)("div",{children:t.map((function(e){return Object(w.jsx)(R,{trackName:e.trackName,previewUrl:e.previewUrl,trackId:e.trackId,favorites:r,objTotal:e},e.trackId)}))});return Object(w.jsxs)("div",{"data-testid":"page-album",children:[Object(w.jsx)(S,{}),Object(w.jsxs)("div",{children:[Object(w.jsx)("img",{src:a.artworkUrl100,alt:a.artistName}),Object(w.jsx)("p",{"data-testid":"album-name",children:a.collectionName}),Object(w.jsx)("p",{"data-testid":"artist-name",children:a.artistName})]}),n?Object(w.jsx)(J,{}):s]})}}]),a}(r.a.Component),K=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).getSongs=Object(h.a)(b.a.mark((function t(){var a;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,U();case 2:a=t.sent,e.setState({songs:a});case 4:case"end":return t.stop()}}),t)}))),e.handleFav=function(t){var a=t.target,n=e.state.songs.find((function(e){return e.trackId===parseInt(a.value,10)}));e.setState({isLoading:!0},Object(h.a)(b.a.mark((function t(){var a;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,P(n);case 2:return t.next=4,U();case 4:a=t.sent,e.setState({isLoading:!1,songs:a});case 6:case"end":return t.stop()}}),t)}))))},e.state={isLoading:!1,songs:[],isFav:!0},e}return Object(o.a)(a,[{key:"componentDidMount",value:function(){this.getSongs()}},{key:"render",value:function(){var e=this,t=this.state,a=t.isLoading,n=t.songs,r=t.isFav;return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(S,{}),Object(w.jsxs)("main",{"data-testid":"page-favorites",children:[Object(w.jsx)("p",{children:"Favoritos"}),a?Object(w.jsx)(J,{}):Object(w.jsx)("div",{children:n.map((function(t){var a=t.trackName,n=t.previewUrl,s=t.trackId,i=t.artworkUrl60;return Object(w.jsxs)("div",{children:[Object(w.jsx)("p",{children:a}),Object(w.jsx)("img",{src:i,alt:a}),Object(w.jsxs)("audio",{"data-testid":"audio-component",src:n,controls:!0,children:[Object(w.jsx)("track",{kind:"captions"}),"O seu navegador n\xe3o suporta o elemento ",Object(w.jsx)("code",{children:"audio"}),"."]}),Object(w.jsxs)("label",{htmlFor:s,"data-testid":"checkbox-music-".concat(s),children:["Favorita",Object(w.jsx)("input",{id:s,name:"fav",type:"checkbox",value:s,checked:r,onChange:e.handleFav})]})]},s)}))})]})]})}}]),a}(r.a.Component),B=a(14),G=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).handleChange=function(t){var a=t.target,n=a.name,r=a.value;e.setState(Object(B.a)({},n,r),(function(){r.length>=3?e.setState({isDisabled:!1}):e.setState({isDisabled:!0})}))},e.handleClick=function(){e.setState({isLoading:!0},Object(h.a)(b.a.mark((function t(){var a,n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.state.user,n=e.props.history,t.next=4,g({name:a});case 4:n.push("/trybetunes/search");case 5:case"end":return t.stop()}}),t)}))))},e.state={user:"",isDisabled:!0,isLoading:!1},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this.state,t=e.user,a=e.isDisabled,n=e.isLoading;return Object(w.jsxs)("div",{"data-testid":"page-login",className:"container-login",children:[Object(w.jsx)("span",{className:"logo-login"}),n?Object(w.jsx)(y.a,{type:"bars",color:"#f72585",width:"100px",height:"100px"}):Object(w.jsxs)("form",{children:[Object(w.jsx)("label",{htmlFor:"user",children:Object(w.jsx)("input",{"data-testid":"login-name-input",id:"user",type:"text",name:"user",value:t,placeholder:"Usu\xe1rio",onChange:this.handleChange})}),Object(w.jsx)("label",{htmlFor:"password",children:Object(w.jsx)("input",{type:"password",id:"password",placeholder:"Senha"})}),Object(w.jsx)("button",{"data-testid":"login-submit-button",type:"button",disabled:a,onClick:this.handleClick,children:"Entrar"})]})]})}}]),a}(r.a.Component),q=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){return Object(w.jsx)("div",{"data-testid":"page-not-found",children:Object(w.jsx)("p",{children:"404"})})}}]),a}(r.a.Component),_=q,z=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).handleUser=Object(h.a)(b.a.mark((function t(){var a;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x();case 2:a=t.sent,e.setState({isLoading:!1,user:a});case 4:case"end":return t.stop()}}),t)}))),e.state={isLoading:!0,user:{}},e}return Object(o.a)(a,[{key:"componentDidMount",value:function(){this.handleUser()}},{key:"render",value:function(){var e=this.state,t=e.isLoading,a=e.user;return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(S,{}),Object(w.jsxs)("main",{"data-testid":"page-profile",children:[Object(w.jsx)("p",{children:"Perfil"}),Object(w.jsx)("div",{children:t?Object(w.jsx)(J,{}):Object(w.jsxs)("div",{children:[Object(w.jsx)("img",{"data-testid":"profile-image",src:a.image,alt:a.name}),Object(w.jsxs)("p",{children:["Nome:",Object(w.jsx)("span",{children:a.name})]}),Object(w.jsxs)("p",{children:["Email:",Object(w.jsx)("span",{children:a.email})]}),Object(w.jsxs)("p",{children:["Descri\xe7\xe3o:",Object(w.jsx)("span",{children:a.description})]}),Object(w.jsx)(p.b,{to:"profile/edit",children:"Editar perfil"})]})})]})]})}}]),a}(r.a.Component),H=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).allUserInfoExist=function(){var t=e.state.user;Object.values(t).includes("")||e.setState({isDisabled:!1})},e.handleUser=Object(h.a)(b.a.mark((function t(){var a;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x();case 2:a=t.sent,e.setState({isLoading:!1,user:a},(function(){e.allUserInfoExist()}));case 4:case"end":return t.stop()}}),t)}))),e.handleChange=function(t){var a=t.target,n=a.name,r=a.value;e.setState((function(e){return{user:Object(O.a)(Object(O.a)({},e.user),{},Object(B.a)({},n,r))}}),(function(){e.allUserInfoExist()}))},e.saveProfile=function(){var t,a=e.state.user,n=a.name,r=a.email,s=a.description,i=a.image,c=e.props.history;t={name:n,email:r,image:i,description:s},new Promise((function(e){f(Object(O.a)({},t)),v("OK")(e)})),c.push("/trybetunes/profile")},e.state={isLoading:!0,user:{},isDisabled:!0},e}return Object(o.a)(a,[{key:"componentDidMount",value:function(){this.handleUser()}},{key:"render",value:function(){var e=this.state,t=e.isLoading,a=e.user,n=a.name,r=a.email,s=a.description,i=a.image,c=e.isDisabled;return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(S,{}),Object(w.jsxs)("main",{"data-testid":"page-profile-edit",children:[Object(w.jsx)("p",{children:"Editar Perfil"}),t?Object(w.jsx)(J,{}):Object(w.jsxs)("form",{children:[Object(w.jsxs)("label",{htmlFor:"name",children:["Editar nome:",Object(w.jsx)("input",{"data-testid":"edit-input-name",id:"name",name:"name",type:"text",value:n,onChange:this.handleChange})]}),Object(w.jsxs)("label",{htmlFor:"email",children:["Editar e-mail:",Object(w.jsx)("input",{"data-testid":"edit-input-email",id:"email",name:"email",type:"email",value:r,onChange:this.handleChange})]}),Object(w.jsxs)("label",{htmlFor:"description",children:["Editar descri\xe7\xe3o:",Object(w.jsx)("input",{"data-testid":"edit-input-description",id:"description",name:"description",type:"text",value:s,onChange:this.handleChange})]}),Object(w.jsxs)("label",{htmlFor:"image",children:["Url da imagem:",Object(w.jsx)("input",{"data-testid":"edit-input-image",id:"image",name:"image",type:"text",value:i,onChange:this.handleChange})]}),Object(w.jsx)("button",{"data-testid":"edit-button-save",type:"button",disabled:c,onClick:this.saveProfile,children:"Salvar"})]})]})]})}}]),a}(r.a.Component),Q=function(){var e=Object(h.a)(b.a.mark((function e(t){var a,n,r,s,i,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=encodeURI(t).replaceAll("%20","+"),n="https://itunes.apple.com/search?entity=album&term=".concat(a,"&attribute=allArtistTerm"),e.next=4,fetch(n);case 4:return r=e.sent,e.next=7,r.json();case 7:return s=e.sent,i=s.results,c=i.map((function(e){return{artistId:e.artistId,artistName:e.artistName,collectionId:e.collectionId,collectionName:e.collectionName,collectionPrice:e.collectionPrice,artworkUrl100:e.artworkUrl100,releaseDate:e.releaseDate,trackCount:e.trackCount}})),e.abrupt("return",c);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=Q,W=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).handleChange=function(t){var a=t.target,n=a.name,r=a.value;e.setState(Object(B.a)({},n,r),(function(){r.length>=2&&e.setState({isDisabled:!1})}))},e.searchResult=Object(h.a)(b.a.mark((function t(){var a,n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.state.search,t.next=3,V(a);case 3:n=t.sent,e.setState((function(e){return{termSearch:e.search,search:"",isLoading:!0,hasResults:!0,results:n}}),(function(){e.setState({isLoading:!1})}));case 5:case"end":return t.stop()}}),t)}))),e.state={search:"",termSearch:"",isDisabled:!0,isLoading:!1,hasResults:!1,results:[]},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this.state,t=e.isDisabled,a=e.search,n=e.isLoading,r=e.hasResults,s=e.termSearch,i=e.results;return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(S,{}),Object(w.jsxs)("main",{"data-testid":"page-search",children:[Object(w.jsxs)("div",{className:"search-container",children:[Object(w.jsxs)("form",{children:[Object(w.jsx)("input",{"data-testid":"search-artist-input",type:"text",name:"search",value:a,onChange:this.handleChange}),Object(w.jsx)("button",{"data-testid":"search-artist-button",type:"button",disabled:t,onClick:this.searchResult,children:"Pesquisar"})]}),r?Object(w.jsx)("p",{children:"Resultado de \xe1lbuns de: ".concat(s)}):Object(w.jsx)("p",{children:"Digite um album ou artista"})]}),Object(w.jsx)("div",{className:"search-main",children:n?Object(w.jsx)(J,{}):i.map((function(e){var t=e.artistName,a=e.artworkUrl100,n=e.collectionId,r=e.collectionName;return Object(w.jsxs)("div",{className:"search-card",children:[Object(w.jsx)("img",{src:a,alt:t}),Object(w.jsx)("p",{children:t.slice(0,30)}),Object(w.jsx)(p.b,{"data-testid":"link-to-album-".concat(n),to:"/trybetunes/album/".concat(n),children:Object(w.jsx)("p",{children:r.slice(0,30)})})]},n)}))})]})]})}}]),a}(r.a.Component),X=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){return Object(w.jsxs)(d.c,{children:[Object(w.jsx)(d.a,{exact:!0,path:"/trybetunes",component:G}),Object(w.jsx)(d.a,{path:"/trybetunes/search",component:W}),Object(w.jsx)(d.a,{path:"/trybetunes/album/:id",component:A}),Object(w.jsx)(d.a,{path:"/trybetunes/favorites",component:K}),Object(w.jsx)(d.a,{exact:!0,path:"/trybetunes/profile",component:z}),Object(w.jsx)(d.a,{path:"/trybetunes/profile/edit",component:H}),Object(w.jsx)(d.a,{path:"*",component:_})]})}}]),a}(r.a.Component),Y=X;i.a.render(Object(w.jsx)(p.a,{children:Object(w.jsx)(Y,{})}),document.getElementById("root"))}},[[41,1,2]]]);
//# sourceMappingURL=main.b7f16a8c.chunk.js.map